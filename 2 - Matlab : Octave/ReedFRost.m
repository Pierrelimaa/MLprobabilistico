%Epidemics Reed Frostclose all; clear all; clc;N=500; %Family sizeNt=100; %final timep=0.125; %contact probability S=zeros(Nt,1); I=S;I(1,1)=2; %Initial number of infectives S(1,1)=N-I(1,1);%%%%function b=reebin(m,n) global num den1 den2 num=m;den1=n;den2=m-n;if(m<n)b=0;elseif (m<(m-n))b=0 elseb=factorial(num)/(factorial(den1)*factorial(den2)); endendfor nt=2:Nt q1=(1-p)^(I(nt-1,1));   r=rand;q=0;for k=0:S(nt-1,1)q=q+reebin(S(nt-1,1),k)*q1^k*(1-q1)^(S(nt-1,1)-k);if(q>r) break; end endS(nt,1)=k;I(nt,1)=S(nt-1,1)-k; endplot(1:Nt,S,1:Nt,I)