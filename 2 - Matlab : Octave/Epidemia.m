n=4p=.125sick = 2;SIR = zeros(1,n+1); x = 0:n;tau = 0;healthy=n+1; %number of healthy peoplewhile healthy > 1  && sick>0 %run while there are sick & healthy peoplefor Sz = 0:x(healthy); %potential number of people who donâ€™t get sickSIR(1, Sz+1) = [nchoosek(x(healthy), Sz) * (1-p)^(sick*Sz) * (1-(1-p)^sick)^(x(healthy)-Sz)] ;    end       SIR(1, x(healthy)+2:end) = zeros(1,length(SIR(1, x(healthy)+2:end))); %delete old probabilitiescdf = cumsum(SIR(1,:));u = rand;healthy = 1;while cdf(healthy) <= u %choose an new number of healthy people according to trans.prob        healthy = healthy+1;    endx(healthy) %new number of healthy people in population +1sick = size(find(SIR),2) - x(healthy) %new number of sick people tau = tau + 1;end